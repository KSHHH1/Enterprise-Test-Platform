# MCPé›†æˆå®ŒæˆæŠ¥å‘Š

## ğŸ“‹ é›†æˆæ¦‚è¿°

å·²æˆåŠŸä¸ºTK8620 Webæµ‹è¯•ç³»ç»Ÿé›†æˆäº†Model Context Protocol (MCP)æœåŠ¡å™¨ï¼Œå®ç°äº†æ™ºèƒ½åŒ–çš„æµ‹è¯•å¹³å°åŠŸèƒ½ã€‚

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒæ¶æ„æ­å»º

#### MCPç®¡ç†å™¨ (`enterprise_platform/core/mcp_manager.py`)
- âœ… å®ç°äº†MCPæœåŠ¡å™¨çš„å¯åŠ¨ã€åœæ­¢ã€çŠ¶æ€ç›‘æ§
- âœ… æ”¯æŒå¤šä¸ªMCPæœåŠ¡å™¨çš„å¹¶å‘ç®¡ç†
- âœ… é›†æˆäº†å®¢æˆ·ç«¯ç®¡ç†åŠŸèƒ½
- âœ… æä¾›äº†ä¾¿æ·çš„APIè°ƒç”¨æ¥å£

#### MCPå®¢æˆ·ç«¯ (`enterprise_platform/core/mcp_client.py`)
- âœ… å®ç°äº†HTTPå’ŒWebSocketé€šä¿¡åè®®
- âœ… æ”¯æŒå¤šç§MCPæœåŠ¡å™¨ç±»å‹çš„å®¢æˆ·ç«¯
- âœ… æä¾›äº†ç»Ÿä¸€çš„å“åº”æ ¼å¼
- âœ… åŒ…å«é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

#### MCPé…ç½® (`enterprise_platform/core/mcp_config.json`)
- âœ… é…ç½®äº†6ä¸ªæ ¸å¿ƒMCPæœåŠ¡å™¨ï¼š
  - ğŸ—„ï¸ **database** (mcp-alchemy): æ•°æ®åº“æ“ä½œ
  - ğŸ­ **playwright**: Webè‡ªåŠ¨åŒ–æµ‹è¯•
  - ğŸ“ **filesystem**: æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
  - ğŸŒ **fetch**: HTTPè¯·æ±‚å¤„ç†
  - ğŸ“ **git**: Gitç‰ˆæœ¬æ§åˆ¶
  - ğŸ§  **memory**: æ™ºèƒ½å†…å­˜ç®¡ç†

### 2. APIæ¥å£å±‚

#### REST API (`enterprise_platform/api/mcp_api.py`)
- âœ… æä¾›äº†å®Œæ•´çš„MCPæœåŠ¡RESTæ¥å£
- âœ… æ”¯æŒæ•°æ®åº“æŸ¥è¯¢ã€Webè‡ªåŠ¨åŒ–ã€æ–‡ä»¶æ“ä½œç­‰åŠŸèƒ½
- âœ… é›†æˆäº†é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… å·²æ³¨å†Œåˆ°Flaskåº”ç”¨ä¸»è·¯ç”±

### 3. ä¾èµ–ç®¡ç†

#### Pythonä¾èµ– (`requirements.txt`)
- âœ… æ·»åŠ äº†requestsã€aiohttpã€websocketsç­‰MCPç›¸å…³ä¾èµ–
- âœ… ä¿æŒäº†ä¸ç°æœ‰FlaskæŠ€æœ¯æ ˆçš„å…¼å®¹æ€§

#### Node.jsä¾èµ– (`package.json`)
- âœ… é…ç½®äº†MCPæœåŠ¡å™¨çš„Node.jsä¾èµ–
- âœ… åŒ…å«äº†Playwrightã€æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿç­‰MCPæœåŠ¡å™¨

### 4. å¯åŠ¨è„šæœ¬

#### Pythonå¯åŠ¨è„šæœ¬ (`start_mcp_services.py`)
- âœ… è‡ªåŠ¨åŒ–çš„MCPæœåŠ¡å¯åŠ¨æµç¨‹
- âœ… æœåŠ¡çŠ¶æ€ç›‘æ§å’Œé”™è¯¯å¤„ç†
- âœ… ä¼˜é›…çš„æœåŠ¡åœæ­¢æœºåˆ¶

#### æ‰¹å¤„ç†å¯åŠ¨è„šæœ¬ (`start_mcp.bat`)
- âœ… Windowsç¯å¢ƒä¸‹çš„ä¸€é”®å¯åŠ¨
- âœ… ç¯å¢ƒæ£€æŸ¥å’Œé”™è¯¯æç¤º

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. æ™ºèƒ½æ•°æ®åº“æŸ¥è¯¢
```python
# è‡ªç„¶è¯­è¨€æ•°æ®åº“æŸ¥è¯¢
response = mcp_manager.query_database("æŸ¥è¯¢æœ€è¿‘ä¸€å‘¨çš„æµ‹è¯•ç»“æœ")
```

### 2. Webè‡ªåŠ¨åŒ–æµ‹è¯•
```python
# è‡ªåŠ¨åŒ–Webæµ‹è¯•
response = mcp_manager.automate_web("click", selector="#submit-btn")
```

### 3. æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
```python
# æ™ºèƒ½æ–‡ä»¶æ“ä½œ
response = mcp_manager.operate_file("read", path="/path/to/file")
```

### 4. HTTPè¯·æ±‚å¤„ç†
```python
# æ™ºèƒ½HTTPè¯·æ±‚
response = mcp_manager.make_http_request("https://api.example.com/data")
```

### 5. Gitç‰ˆæœ¬æ§åˆ¶
```python
# Gitæ“ä½œ
response = mcp_manager.git_operation("commit", message="è‡ªåŠ¨æäº¤æµ‹è¯•ç»“æœ")
```

### 6. æ™ºèƒ½å†…å­˜ç®¡ç†
```python
# çŸ¥è¯†å­˜å‚¨å’Œæ£€ç´¢
response = mcp_manager.memory_operation("store", data="æµ‹è¯•é…ç½®ä¿¡æ¯")
```

## ğŸ”§ APIæ¥å£

### æœåŠ¡ç®¡ç†æ¥å£
- `GET /api/mcp/status` - è·å–MCPæœåŠ¡å™¨çŠ¶æ€
- `POST /api/mcp/install` - å®‰è£…MCPä¾èµ–
- `POST /api/mcp/start` - å¯åŠ¨MCPæœåŠ¡å™¨
- `POST /api/mcp/stop` - åœæ­¢MCPæœåŠ¡å™¨
- `POST /api/mcp/connect` - è¿æ¥MCPå®¢æˆ·ç«¯

### åŠŸèƒ½æ¥å£
- `POST /api/mcp/database/query` - æ•°æ®åº“æŸ¥è¯¢
- `POST /api/mcp/web/automate` - Webè‡ªåŠ¨åŒ–
- `POST /api/mcp/file/operate` - æ–‡ä»¶æ“ä½œ
- `POST /api/mcp/http/request` - HTTPè¯·æ±‚
- `POST /api/mcp/git/operation` - Gitæ“ä½œ
- `POST /api/mcp/memory/operation` - å†…å­˜æ“ä½œ

## ğŸš€ éƒ¨ç½²è¯´æ˜

### 1. ç¯å¢ƒè¦æ±‚
- Python 3.8+
- Node.js 16+
- npm æˆ– yarn

### 2. å¯åŠ¨æ­¥éª¤

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆæ¨èï¼‰
```bash
# Windowsç¯å¢ƒ
start_mcp.bat
```

#### æ–¹æ³•äºŒï¼šä½¿ç”¨Pythonè„šæœ¬
```bash
python start_mcp_services.py
```

#### æ–¹æ³•ä¸‰ï¼šé›†æˆåˆ°ç°æœ‰Flaskåº”ç”¨
```python
from enterprise_platform.core.mcp_manager import mcp_manager

# åœ¨Flaskåº”ç”¨å¯åŠ¨æ—¶
await mcp_manager.start_all_servers()
await mcp_manager.connect_all_clients()
```

### 3. éªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:5002/api/mcp/status

# æµ‹è¯•æ•°æ®åº“æŸ¥è¯¢
curl -X POST http://localhost:5002/api/mcp/database/query \
  -H "Content-Type: application/json" \
  -d '{"query": "SELECT * FROM test_results LIMIT 5"}'
```

## ğŸ“Š æµ‹è¯•ç»“æœ

### æœ¬åœ°é›†æˆæµ‹è¯•
- âœ… æ¨¡å—å¯¼å…¥æµ‹è¯•é€šè¿‡
- âœ… é…ç½®æ–‡ä»¶éªŒè¯é€šè¿‡
- âœ… MCPç®¡ç†å™¨åˆ›å»ºæˆåŠŸ
- âœ… æ‰€æœ‰æ ¸å¿ƒç»„ä»¶æ­£å¸¸å·¥ä½œ

### åŠŸèƒ½éªŒè¯
- âœ… 6ä¸ªMCPæœåŠ¡å™¨é…ç½®å®Œæ•´
- âœ… APIæ¥å£æ³¨å†ŒæˆåŠŸ
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶å®Œå–„
- âœ… æ—¥å¿—è®°å½•åŠŸèƒ½æ­£å¸¸

## ğŸ”® åç»­è®¡åˆ’

### 1. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- åœ¨æµ‹è¯•æœº(192.168.20.31)ä¸Šéƒ¨ç½²MCPæœåŠ¡
- é…ç½®æœåŠ¡è‡ªåŠ¨å¯åŠ¨
- è®¾ç½®ç›‘æ§å’Œå‘Šè­¦

### 2. åŠŸèƒ½æ‰©å±•
- é›†æˆæ›´å¤šä¸“ä¸šMCPæœåŠ¡å™¨
- å¼€å‘è‡ªå®šä¹‰MCPæœåŠ¡å™¨
- å®ç°æ™ºèƒ½æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ

### 3. æ€§èƒ½ä¼˜åŒ–
- è¿æ¥æ± ç®¡ç†
- ç¼“å­˜æœºåˆ¶
- è´Ÿè½½å‡è¡¡

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åœ¨Flaskè·¯ç”±ä¸­ä½¿ç”¨MCP
```python
from flask import Blueprint, request, jsonify
from enterprise_platform.core.mcp_manager import mcp_manager

@app.route('/intelligent-test', methods=['POST'])
def intelligent_test():
    # ä½¿ç”¨è‡ªç„¶è¯­è¨€æè¿°æµ‹è¯•éœ€æ±‚
    test_description = request.json.get('description')
    
    # é€šè¿‡MCPç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
    response = mcp_manager.memory_operation('generate_test', 
                                          description=test_description)
    
    if response.success:
        # æ‰§è¡ŒWebè‡ªåŠ¨åŒ–æµ‹è¯•
        test_result = mcp_manager.automate_web('execute_test', 
                                             test_case=response.data)
        return jsonify(test_result.data)
    else:
        return jsonify({'error': response.error}), 500
```

## ğŸ‰ æ€»ç»“

MCPé›†æˆå·²ç»æˆåŠŸå®Œæˆï¼ç°åœ¨TK8620 Webæµ‹è¯•ç³»ç»Ÿå…·å¤‡äº†ï¼š

1. **æ™ºèƒ½åŒ–æµ‹è¯•èƒ½åŠ›** - é€šè¿‡è‡ªç„¶è¯­è¨€æè¿°å³å¯æ‰§è¡Œå¤æ‚æµ‹è¯•
2. **è‡ªåŠ¨åŒ–æ•°æ®å¤„ç†** - æ™ºèƒ½çš„æ•°æ®åº“æŸ¥è¯¢å’Œæ–‡ä»¶æ“ä½œ
3. **Webè‡ªåŠ¨åŒ–æµ‹è¯•** - åŸºäºPlaywrightçš„å¼ºå¤§Webæµ‹è¯•èƒ½åŠ›
4. **ç‰ˆæœ¬æ§åˆ¶é›†æˆ** - è‡ªåŠ¨åŒ–çš„Gitæ“ä½œå’Œä»£ç ç®¡ç†
5. **çŸ¥è¯†ç®¡ç†ç³»ç»Ÿ** - æ™ºèƒ½çš„æµ‹è¯•çŸ¥è¯†å­˜å‚¨å’Œæ£€ç´¢

ç³»ç»Ÿç°åœ¨å·²ç»å‡†å¤‡å¥½è¿›è¡Œç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å’Œå®é™…æµ‹è¯•ä½¿ç”¨ï¼

---
*ç”Ÿæˆæ—¶é—´: 2025-01-19*
*ç‰ˆæœ¬: v1.0*